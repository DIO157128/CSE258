Function readPredict() implements a hybrid recommendation model based on a Jaccard similarity threshold and a popularity threshold. It first reads and parses training data from train_Interactions.csv.gz to build dictionaries that map users to the books they've read and books to the users who've read them. The function calculates a popularity threshold by selecting books that are read by the highest proportion of users, using this threshold to filter books for recommendation. It also introduces an adaptive Jaccard threshold that adjusts based on user and book characteristics. Each user-book pair in pairs_Read.csv is evaluated based on either meeting the adaptive Jaccard similarity or being popular enough to pass the popularity threshold.
Function readPredict() performs a recommendation task by training a bias-based model to predict user ratings for items. Initially, it loads and splits the training data from train_Interactions.csv.gz into training and validation sets, then organizes ratings by users and items. It maps user and item IDs into indexed representations and trains a bias model across different regularization (位) values to find the optimal setting. For each 位, the function calculates mean squared error (MSE) on the validation set, keeping track of the best 位 that minimizes MSE. Then choose the best 位 to train the model. Using the optimal parameters, it predicts ratings for pairs in pairs_Rating.csv and outputs the results to predictions_Rating.csv.